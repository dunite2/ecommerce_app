<!-- Order Details Page -->
<div class="container mt-4">
  <div class="row">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
          <h1 class="page-title">Order #<%= @order.id %></h1>
          <p class="page-subtitle">Placed on <%= @order.created_at.strftime("%B %d, %Y at %I:%M %p") %></p>
        </div>
        <div>
          <span class="badge bg-<%= @order.status == 'pending' ? 'warning' : 
                                     @order.status == 'processing' ? 'info' :
                                     @order.status == 'shipped' ? 'primary' :
                                     @order.status == 'delivered' ? 'success' : 'secondary' %> fs-6">
            <%= @order.status.titleize %>
          </span>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <!-- Order Items -->
    <div class="col-lg-8">
      <div class="card mb-4">
        <div class="card-header">
          <h5 class="mb-0">Order Items</h5>
        </div>
        <div class="card-body">
          <% @order_items.each do |item| %>
            <div class="d-flex justify-content-between align-items-center py-3 <%= 'border-bottom' unless item == @order_items.last %>">
              <div class="d-flex align-items-center">
                <div class="me-3">
                  <%= image_tag item.product.image.present? ? item.product.image : "isuzu.jpg", 
                        alt: item.product.name, class: "img-thumbnail", style: "width: 80px; height: 80px; object-fit: cover;" %>
                </div>
                <div>
                  <h6 class="mb-1"><%= item.product.name %></h6>
                  <p class="text-muted mb-1"><%= truncate(item.product.descrption, length: 80) %></p>
                  <small class="text-muted">Quantity: <%= item.quality %> Ã— $<%= sprintf("%.2f", item.price) %></small>
                </div>
              </div>
              <div class="text-end">
                <strong>$<%= sprintf("%.2f", item.total_price) %></strong>
                <br>
                <small class="text-muted">
                  <%= link_to "View Product", product_path(item.product), class: "text-decoration-none" %>
                </small>
              </div>
            </div>
          <% end %>
        </div>
      </div>

      <!-- Shipping Information -->
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0">Shipping Information</h5>
        </div>
        <div class="card-body">
          <address class="mb-0">
            <%= simple_format(@order.shipping_address) %>
          </address>
        </div>
      </div>
    </div>

    <!-- Order Summary -->
    <div class="col-lg-4">
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0">Order Summary</h5>
        </div>
        <div class="card-body">
          <div class="d-flex justify-content-between mb-2">
            <span>Items (<%= @order.total_items %>):</span>
            <span>$<%= sprintf("%.2f", @order.total) %></span>
          </div>
          <div class="d-flex justify-content-between mb-2">
            <span>Shipping:</span>
            <span>Free</span>
          </div>
          <div class="d-flex justify-content-between mb-2">
            <span>Tax:</span>
            <span>$0.00</span>
          </div>
          <hr>
          <div class="d-flex justify-content-between">
            <strong>Total:</strong>
            <strong>$<%= sprintf("%.2f", @order.total) %></strong>
          </div>
        </div>
      </div>

      <!-- Order Status -->
      <div class="card mt-3">
        <div class="card-header">
          <h5 class="mb-0">Order Status</h5>
        </div>
        <div class="card-body">
          <div class="status-timeline">
            <div class="status-item <%= 'active' if ['pending', 'processing', 'shipped', 'delivered'].include?(@order.status) %>">
              <i class="fas fa-shopping-cart"></i>
              <span>Order Placed</span>
            </div>
            <div class="status-item <%= 'active' if ['processing', 'shipped', 'delivered'].include?(@order.status) %>">
              <i class="fas fa-cog"></i>
              <span>Processing</span>
            </div>
            <div class="status-item <%= 'active' if ['shipped', 'delivered'].include?(@order.status) %>">
              <i class="fas fa-truck"></i>
              <span>Shipped</span>
            </div>
            <div class="status-item <%= 'active' if @order.status == 'delivered' %>">
              <i class="fas fa-check-circle"></i>
              <span>Delivered</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Actions -->
      <div class="card mt-3">
        <div class="card-body">
          <%= link_to "View All Orders", orders_path, class: "btn btn-outline-success w-100 mb-2" %>
          <%= link_to "Continue Shopping", products_path, class: "btn btn-success w-100" %>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.status-timeline {
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.status-item {
  display: flex;
  align-items: center;
  gap: 10px;
  color: #6c757d;
}

.status-item.active {
  color: #198754;
  font-weight: 500;
}

.status-item i {
  width: 20px;
  text-align: center;
}
</style>
